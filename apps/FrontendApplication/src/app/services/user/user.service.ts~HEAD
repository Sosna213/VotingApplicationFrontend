import { Injectable } from '@angular/core';
import {HttpClient} from "@angular/common/http";
import {Observable, Subject} from "rxjs";
import {UserRegisterModel} from "../../components/register/register.component";
import {TokenDecoderService} from "../token-decoder/token-decoder.service";

@Injectable({
  providedIn: 'root'
})
export class UserService {

  constructor(private http: HttpClient, private tokenDecoder: TokenDecoderService) { }

<<<<<<< HEAD:apps/FrontendApplication/src/app/services/user/user.service.ts
  public registerUser(url: string, data: UserRegisterModel): Observable<Object>{
=======
  public registerUser(url: String, data: UserRegisterModel): Observable<Object>{
    let response: any;
>>>>>>> parent of 14d89c8 (Changes due adding keycloak integration in backend):src/app/services/user/user.service.ts
    return this.http.post('/register', data);

  }
  public getActiveUserId(): Observable<number>{

<<<<<<< HEAD:apps/FrontendApplication/src/app/services/user/user.service.ts
    const userId = new Subject<number>()
    const userKcId = this.tokenDecoder.getUserIdFromToken();
=======
    let userId = new Subject<number>()
    let username = this.tokenDecoder.getUsernameFromToken();
>>>>>>> parent of 14d89c8 (Changes due adding keycloak integration in backend):src/app/services/user/user.service.ts

    this.http.get<number>(`/userId/${username}`)
      .subscribe(response =>{
        userId.next(response);
        return userId;
      }, error => {
        console.log(error);
      });
    return userId;
  }
  public getUsernames(): Observable<string[]>{
    return this.http.get<string[]>('/usernames');
  }
}
